<!DOCTYPE html>
<!-- saved from url=(0029)https://xz.aliyun.com/t/12970 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>逻辑漏洞背后隐藏的刷票总结 - 先知社区</title>
    <meta name="description" content="先知社区，先知安全技术社区">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" href="https://xz.aliyun.com/static/icon/favicon.ico" type="image/x-icon">
    <link href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/editormd.min.css">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/tango.css">
    <link href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/bootstrap-responsive.min.css" rel="stylesheet">
    <!-- Le styles -->
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/OverlayStyle.css">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/topic.css">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/beautify.css">
    
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/editormd.css">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/tango.css">
    <link rel="stylesheet" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/jquery.fancybox.min.css">

    <!--[if lte IE 8]>
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <![endif]-->
    
    

    <!--[if !IE]> -->
    <script type="text/javascript" src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/jquery-2.1.3.min.js.下载"></script>
    
    
    <script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/jquery.fancybox.min.js.下载"></script>

    <!-- <![endif]-->
<style type="text/css">@font-face {
  font-family: "xm-iconfont";
  src: url('//at.alicdn.com/t/font_792691_ptvyboo0bno.eot?t=1574048839056');
  /* IE9 */
  src: url('//at.alicdn.com/t/font_792691_ptvyboo0bno.eot?t=1574048839056#iefix') format('embedded-opentype'), /* IE6-IE8 */ url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'), url('//at.alicdn.com/t/font_792691_ptvyboo0bno.woff?t=1574048839056') format('woff'), url('//at.alicdn.com/t/font_792691_ptvyboo0bno.ttf?t=1574048839056') format('truetype'), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */ url('//at.alicdn.com/t/font_792691_ptvyboo0bno.svg?t=1574048839056#iconfont') format('svg');
  /* iOS 4.1- */
}
.xm-iconfont {
  font-family: "xm-iconfont" !important;
  font-size: 16px;
  font-style: normal;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.xm-icon-quanxuan:before {
  content: "\e62c";
}
.xm-icon-caidan:before {
  content: "\e610";
}
.xm-icon-fanxuan:before {
  content: "\e837";
}
.xm-icon-pifu:before {
  content: "\e668";
}
.xm-icon-qingkong:before {
  content: "\e63e";
}
.xm-icon-sousuo:before {
  content: "\e600";
}
.xm-icon-danx:before {
  content: "\e62b";
}
.xm-icon-duox:before {
  content: "\e613";
}
.xm-icon-close:before {
  content: "\e601";
}
.xm-icon-expand:before {
  content: "\e641";
}
.xm-icon-banxuan:before {
  content: "\e60d";
}
</style><style type="text/css">@-webkit-keyframes xm-upbit {
  from {
    -webkit-transform: translate3d(0, 30px, 0);
    opacity: 0.3;
  }
  to {
    -webkit-transform: translate3d(0, 0, 0);
    opacity: 1;
  }
}
@keyframes xm-upbit {
  from {
    transform: translate3d(0, 30px, 0);
    opacity: 0.3;
  }
  to {
    transform: translate3d(0, 0, 0);
    opacity: 1;
  }
}
@-webkit-keyframes loader {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@keyframes loader {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
xm-select {
  background-color: #FFF;
  position: relative;
  border: 1px solid #E6E6E6;
  border-radius: 2px;
  display: block;
  width: 100%;
  cursor: pointer;
  outline: none;
}
xm-select * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-size: 14px;
  font-weight: 400;
  text-overflow: ellipsis;
  user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
}
xm-select:hover,
xm-select:focus {
  border-color: #C0C4CC;
}
xm-select > .xm-tips {
  color: #999999;
  padding: 0 10px;
  position: absolute;
  display: flex;
  height: 100%;
  align-items: center;
}
xm-select > .xm-icon {
  display: inline-block;
  overflow: hidden;
  position: absolute;
  width: 0;
  height: 0;
  right: 10px;
  top: 50%;
  margin-top: -3px;
  cursor: pointer;
  border: 6px dashed transparent;
  border-top-color: #C2C2C2;
  border-top-style: solid;
  transition: all 0.3s;
  -webkit-transition: all 0.3s;
}
xm-select > .xm-icon-expand {
  margin-top: -9px;
  transform: rotate(180deg);
}
xm-select > .xm-label.single-row {
  position: absolute;
  top: 0;
  bottom: 0px;
  left: 0px;
  right: 30px;
  overflow: auto hidden;
}
xm-select > .xm-label.single-row .scroll {
  overflow-y: hidden;
}
xm-select > .xm-label.single-row .label-content {
  flex-wrap: nowrap;
  white-space: nowrap;
}
xm-select > .xm-label.auto-row .label-content {
  flex-wrap: wrap;
  padding-right: 30px !important;
}
xm-select > .xm-label.auto-row .xm-label-block > span {
  white-space: unset;
  height: 100%;
}
xm-select > .xm-label .scroll .label-content {
  display: flex;
  padding: 3px 10px;
}
xm-select > .xm-label .xm-label-block {
  display: flex;
  position: relative;
  padding: 0px 5px;
  margin: 2px 5px 2px 0;
  border-radius: 3px;
  align-items: baseline;
  color: #FFF;
}
xm-select > .xm-label .xm-label-block > span {
  display: flex;
  color: #FFF;
  white-space: nowrap;
}
xm-select > .xm-label .xm-label-block > i {
  color: #FFF;
  margin-left: 8px;
  font-size: 12px;
  cursor: pointer;
  display: flex;
}
xm-select > .xm-label .xm-label-block.disabled {
  background-color: #C2C2C2 !important;
  cursor: no-drop !important;
}
xm-select > .xm-label .xm-label-block.disabled > i {
  cursor: no-drop !important;
}
xm-select > .xm-body {
  position: absolute;
  left: 0;
  top: 42px;
  padding: 5px 0;
  z-index: 999;
  width: 100%;
  min-width: fit-content;
  border: 1px solid #E6E6E6;
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12);
  animation-name: xm-upbit;
  animation-duration: 0.3s;
  animation-fill-mode: both;
}
xm-select > .xm-body .scroll-body {
  overflow-x: hidden;
  overflow-y: auto;
}
xm-select > .xm-body .scroll-body::-webkit-scrollbar {
  width: 8px;
}
xm-select > .xm-body .scroll-body::-webkit-scrollbar-track {
  -webkit-border-radius: 2em;
  -moz-border-radius: 2em;
  -ms-border-radius: 2em;
  border-radius: 2em;
  background-color: #FFF;
}
xm-select > .xm-body .scroll-body::-webkit-scrollbar-thumb {
  -webkit-border-radius: 2em;
  -moz-border-radius: 2em;
  -ms-border-radius: 2em;
  border-radius: 2em;
  background-color: #C2C2C2;
}
xm-select > .xm-body.up {
  top: auto;
  bottom: 42px;
}
xm-select > .xm-body.relative {
  position: relative;
  display: block !important;
  top: 0;
  box-shadow: none;
  border: none;
  animation-name: none;
  animation-duration: 0;
  min-width: 100%;
}
xm-select > .xm-body .xm-group {
  cursor: default;
}
xm-select > .xm-body .xm-group-item {
  display: inline-block;
  cursor: pointer;
  padding: 0 10px;
  color: #999;
  font-size: 12px;
}
xm-select > .xm-body .xm-option {
  display: flex;
  align-items: center;
  position: relative;
  padding: 0 10px;
  cursor: pointer;
}
xm-select > .xm-body .xm-option-icon {
  color: transparent;
  display: flex;
  border: 1px solid #E6E6E6;
  border-radius: 3px;
  justify-content: center;
  align-items: center;
}
xm-select > .xm-body .xm-option-icon.xm-custom-icon {
  color: unset;
  border: unset;
}
xm-select > .xm-body .xm-option-icon-hidden {
  margin-right: -10px;
}
xm-select > .xm-body .xm-option-icon.xm-icon-danx {
  border-radius: 100%;
}
xm-select > .xm-body .xm-option-content {
  display: flex;
  position: relative;
  padding-left: 15px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  ;
  width: calc(100% - 20px);
}
xm-select > .xm-body .xm-option.hide-icon .xm-option-content {
  padding-left: 0;
}
xm-select > .xm-body .xm-option.selected.hide-icon .xm-option-content {
  color: #FFF !important;
}
xm-select > .xm-body .xm-option .loader {
  width: 0.8em;
  height: 0.8em;
  margin-right: 6px;
  color: #C2C2C2;
}
xm-select > .xm-body .xm-select-empty {
  text-align: center;
  color: #999;
}
xm-select > .xm-body .disabled {
  cursor: no-drop;
}
xm-select > .xm-body .disabled:hover {
  background-color: #FFF;
}
xm-select > .xm-body .disabled .xm-option-icon {
  border-color: #C2C2C2 !important;
}
xm-select > .xm-body .disabled .xm-option-content {
  color: #C2C2C2 !important;
}
xm-select > .xm-body .disabled.selected > .xm-option-icon {
  color: #C2C2C2 !important;
}
xm-select > .xm-body .xm-search {
  background-color: #FFF !important;
  position: relative;
  padding: 0 10px;
  margin-bottom: 5px;
  cursor: pointer;
}
xm-select > .xm-body .xm-search > i {
  position: absolute;
  color: ;
}
xm-select > .xm-body .xm-search-input {
  border: none;
  border-bottom: 1px solid #E6E6E6;
  padding-left: 27px;
  cursor: text;
}
xm-select > .xm-body .xm-paging {
  padding: 0 10px;
  display: flex;
  margin-top: 5px;
}
xm-select > .xm-body .xm-paging > span:first-child {
  border-radius: 2px 0 0 2px;
}
xm-select > .xm-body .xm-paging > span:last-child {
  border-radius: 0 2px 2px 0;
}
xm-select > .xm-body .xm-paging > span {
  display: flex;
  flex: auto;
  justify-content: center;
  vertical-align: middle;
  margin: 0 -1px 0 0;
  background-color: #fff;
  color: #333;
  font-size: 12px;
  border: 1px solid #e2e2e2;
  flex-wrap: nowrap;
  width: 100%;
  overflow: hidden;
  min-width: 50px;
}
xm-select > .xm-body .xm-toolbar {
  padding: 0 10px;
  display: flex;
  margin: -3px 0;
  cursor: default;
}
xm-select > .xm-body .xm-toolbar .toolbar-tag {
  cursor: pointer;
  display: flex;
  margin-right: 20px;
  color: ;
  align-items: baseline;
}
xm-select > .xm-body .xm-toolbar .toolbar-tag:hover {
  opacity: 0.8;
}
xm-select > .xm-body .xm-toolbar .toolbar-tag:active {
  opacity: 1;
}
xm-select > .xm-body .xm-toolbar .toolbar-tag > i {
  margin-right: 2px;
  font-size: 14px;
}
xm-select > .xm-body .xm-toolbar .toolbar-tag:last-child {
  margin-right: 0;
}
xm-select > .xm-body .xm-body-custom {
  line-height: initial;
  cursor: default;
}
xm-select > .xm-body .xm-body-custom * {
  box-sizing: initial;
}
xm-select > .xm-body .xm-tree {
  position: relative;
}
xm-select > .xm-body .xm-tree-icon {
  display: inline-block;
  margin-right: 3px;
  cursor: pointer;
  border: 6px dashed transparent;
  border-left-color: #C2C2C2;
  border-left-style: solid;
  transition: all 0.3s;
  -webkit-transition: all 0.3s;
  z-index: 2;
  visibility: hidden;
}
xm-select > .xm-body .xm-tree-icon.expand {
  margin-top: 3px;
  margin-right: 5px;
  margin-left: -2px;
  transform: rotate(90deg);
}
xm-select > .xm-body .xm-tree-icon.xm-visible {
  visibility: visible;
}
xm-select > .xm-body .xm-tree .left-line {
  position: absolute;
  left: 13px;
  width: 0;
  z-index: 1;
  border-left: 1px dotted #c0c4cc !important;
}
xm-select > .xm-body .xm-tree .top-line {
  position: absolute;
  left: 13px;
  height: 0;
  z-index: 1;
  border-top: 1px dotted #c0c4cc !important;
}
xm-select > .xm-body .xm-tree .xm-tree-icon + .top-line {
  margin-left: 1px;
}
xm-select > .xm-body .scroll-body > .xm-tree > .xm-option > .top-line,
xm-select > .xm-body .scroll-body > .xm-option > .top-line {
  width: 0 !important;
}
xm-select > .xm-body .xm-cascader-box {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  padding: 5px 0;
  border: 1px solid #E6E6E6;
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12);
  margin: -1px;
}
xm-select > .xm-body .xm-cascader-box::before {
  content: ' ';
  position: absolute;
  width: 0;
  height: 0;
  border: 6px solid transparent;
  border-right-color: #E6E6E6;
  top: 10px;
  left: -12px;
}
xm-select > .xm-body .xm-cascader-box::after {
  content: ' ';
  position: absolute;
  width: 0;
  height: 0;
  border: 6px solid transparent;
  border-right-color: #fff;
  top: 10px;
  left: -11px;
}
xm-select > .xm-body .xm-cascader-scroll {
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
}
xm-select > .xm-body.cascader {
  width: unset;
  min-width: unset;
}
xm-select > .xm-body.cascader .xm-option-content {
  padding-left: 8px;
}
xm-select > .xm-body.cascader .disabled .xm-right-arrow {
  color: #C2C2C2 !important;
}
xm-select > .xm-body.cascader .hide-icon.disabled .xm-right-arrow {
  color: #999 !important;
}
xm-select .xm-input {
  cursor: pointer;
  border-radius: 2px;
  border-width: 1px;
  border-style: solid;
  border-color: #E6E6E6;
  display: block;
  width: 100%;
  box-sizing: border-box;
  background-color: #FFF;
  line-height: 1.3;
  padding-left: 10px;
  outline: 0;
  user-select: text;
  -ms-user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
}
xm-select .dis {
  display: none;
}
xm-select .loading {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
}
xm-select .loader {
  border: 0.2em dotted currentcolor;
  border-radius: 50%;
  -webkit-animation: 1s loader linear infinite;
  animation: 1s loader linear infinite;
  display: inline-block;
  width: 1em;
  height: 1em;
  color: inherit;
  vertical-align: middle;
  pointer-events: none;
}
xm-select .xm-select-default {
  position: absolute;
  width: 100%;
  height: 100%;
  border: none;
  visibility: hidden;
}
xm-select .xm-select-disabled {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  cursor: no-drop;
  z-index: 2;
  opacity: 0.3;
  background-color: #FFF;
}
xm-select .item--divided {
  border-top: 1px solid #ebeef5;
  width: calc(100% - 20px);
  cursor: initial;
}
xm-select .xm-right-arrow {
  position: absolute;
  color: ;
  right: 5px;
  top: -1px;
  font-weight: 700;
  transform: scale(0.6, 1);
}
xm-select .xm-right-arrow::after {
  content: '>';
}
xm-select[size='large'] {
  min-height: 40px;
  line-height: 40px;
}
xm-select[size='large'] .xm-input {
  height: 40px;
}
xm-select[size='large'] .xm-label .scroll .label-content {
  line-height: 34px;
}
xm-select[size='large'] .xm-label .xm-label-block {
  height: 30px;
  line-height: 30px;
}
xm-select[size='large'] .xm-body .xm-option .xm-option-icon {
  height: 20px;
  width: 20px;
  font-size: 20px;
}
xm-select[size='large'] .xm-paging > span {
  height: 34px;
  line-height: 34px;
}
xm-select[size='large'] .xm-tree .left-line {
  height: 100%;
  bottom: 20px;
}
xm-select[size='large'] .xm-tree .left-line-group {
  height: calc(100% - 40px);
}
xm-select[size='large'] .xm-tree .xm-tree-icon.xm-hidden + .top-line {
  top: 19px;
}
xm-select[size='large'] .item--divided {
  margin: 10px;
}
xm-select {
  min-height: 36px;
  line-height: 36px;
}
xm-select .xm-input {
  height: 36px;
}
xm-select .xm-label .scroll .label-content {
  line-height: 30px;
}
xm-select .xm-label .xm-label-block {
  height: 26px;
  line-height: 26px;
}
xm-select .xm-body .xm-option .xm-option-icon {
  height: 18px;
  width: 18px;
  font-size: 18px;
}
xm-select .xm-paging > span {
  height: 30px;
  line-height: 30px;
}
xm-select .xm-tree .left-line {
  height: 100%;
  bottom: 18px;
}
xm-select .xm-tree .left-line-group {
  height: calc(100% - 36px);
}
xm-select .xm-tree .xm-tree-icon.xm-hidden + .top-line {
  top: 17px;
}
xm-select .item--divided {
  margin: 9px;
}
xm-select[size='small'] {
  min-height: 32px;
  line-height: 32px;
}
xm-select[size='small'] .xm-input {
  height: 32px;
}
xm-select[size='small'] .xm-label .scroll .label-content {
  line-height: 26px;
}
xm-select[size='small'] .xm-label .xm-label-block {
  height: 22px;
  line-height: 22px;
}
xm-select[size='small'] .xm-body .xm-option .xm-option-icon {
  height: 16px;
  width: 16px;
  font-size: 16px;
}
xm-select[size='small'] .xm-paging > span {
  height: 26px;
  line-height: 26px;
}
xm-select[size='small'] .xm-tree .left-line {
  height: 100%;
  bottom: 16px;
}
xm-select[size='small'] .xm-tree .left-line-group {
  height: calc(100% - 32px);
}
xm-select[size='small'] .xm-tree .xm-tree-icon.xm-hidden + .top-line {
  top: 15px;
}
xm-select[size='small'] .item--divided {
  margin: 8px;
}
xm-select[size='mini'] {
  min-height: 28px;
  line-height: 28px;
}
xm-select[size='mini'] .xm-input {
  height: 28px;
}
xm-select[size='mini'] .xm-label .scroll .label-content {
  line-height: 22px;
}
xm-select[size='mini'] .xm-label .xm-label-block {
  height: 18px;
  line-height: 18px;
}
xm-select[size='mini'] .xm-body .xm-option .xm-option-icon {
  height: 14px;
  width: 14px;
  font-size: 14px;
}
xm-select[size='mini'] .xm-paging > span {
  height: 22px;
  line-height: 22px;
}
xm-select[size='mini'] .xm-tree .left-line {
  height: 100%;
  bottom: 14px;
}
xm-select[size='mini'] .xm-tree .left-line-group {
  height: calc(100% - 28px);
}
xm-select[size='mini'] .xm-tree .xm-tree-icon.xm-hidden + .top-line {
  top: 13px;
}
xm-select[size='mini'] .item--divided {
  margin: 7px;
}
.layui-form-pane xm-select {
  margin: -1px -1px -1px 0;
}
</style><style data-id="immersive-translate-input-injected-css">.immersive-translate-input {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 2147483647;
  display: flex;
  justify-content: center;
  align-items: center;
}

.immersive-translate-loading-spinner {
  vertical-align: middle !important;
  width: 10px !important;
  height: 10px !important;
  display: inline-block !important;
  margin: 0 4px !important;
  border: 2px rgba(221, 244, 255, 0.6) solid !important;
  border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
  border-radius: 50% !important;
  padding: 0 !important;
  -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
  animation: immersive-translate-loading-animation 0.6s infinite linear !important;
}

@-webkit-keyframes immersive-translate-loading-animation {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(359deg);
  }
}

@keyframes immersive-translate-loading-animation {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(359deg);
  }
}


.immersive-translate-input-loading {
  --loading-color: #f78fb6;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: block;
  margin: 12px auto;
  position: relative;
  color: white;
  left: -100px;
  box-sizing: border-box;
  animation: immersiveTranslateShadowRolling 1.5s linear infinite;
}

@keyframes immersiveTranslateShadowRolling {
  0% {
    box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  12% {
    box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  25% {
    box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
  }

  36% {
    box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
  }

  50% {
    box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color), 100px 0 var(--loading-color);
  }

  62% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color), 110px 0 var(--loading-color);
  }

  75% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color), 120px 0 var(--loading-color);
  }

  87% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
  }

  100% {
    box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
  }
}


.immersive-translate-search-recomend {
  border: 1px solid #dadce0;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
  position: relative;
  font-size: 16px;
}
.immersive-translate-search-enhancement-en-title {
  color: #4d5156;
}
/* dark */
@media (prefers-color-scheme: dark) {
  .immersive-translate-search-recomend {
    border: 1px solid #3c4043;
  }
  .immersive-translate-close-action svg {
    fill: #bdc1c6;
  }

.immersive-translate-search-enhancement-en-title {
  color: #bdc1c6;
}
}


.immersive-translate-search-settings {
  position: absolute;
  top: 16px;
  right: 16px;
  cursor: pointer;
}

.immersive-translate-search-recomend::before {
  /* content: " "; */
  /* width: 20px; */
  /* height: 20px; */
  /* top: 16px; */
  /* position: absolute; */
  /* background: center / contain url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAxlBMVEUAAADpTInqTIjpSofnSIfqS4nfS4XqS4nqTIjsTYnrTInqTIroS4jvQIDqTIn////+/v7rSYjpTIn8/v7uaZzrTIr9/f3wfansWJL88/b85e73qc39+/v3xNnylrvrVI/98fb62Obva5/8+fr76vH4y9zpSIj74e353Oj1ocTzm77xhK/veKbtYpjsXJTqU47oTInxjrXyh7L99fj40eH2ttH1udD3sc31ssz1rMnykLXucqPtbqD85e/1xdn2u9DzqcXrUY6FaJb8AAAADnRSTlMA34BgIM8Q37/fz7+/EGOHcVQAAAGhSURBVDjLhZPncuowEEZFTW7bXVU7xsYYTO/p7bb3f6lICIOYJOT4h7/VnFmvrBFjrF3/CR/SajBHswafctG0Qg3O8O0Xa8BZ6uw7eLjqr30SofCDVSkemMinfL1ecy20r5ygR5zz3ArcAqJExPTPKhDENEmS30Q9+yo4lEQkqVTiIEAHCT10xWERRdH0Bq0aCOPZNDV3s0xaYce1lHEoDHU8wEh3qRJypNcTAeKUIjgKMeGLDoRCLVLTVf+Ownj8Kk6H9HM6QXPgYjQSB0F00EJEu10ILQrs/QeP77BSSr0MzLOyuJJQbnUoOOIUI/A8EeJk9E4YUHUWiRyTVKGgQUB8/3e/NpdGlfI+FMQyWsCBWyz4A/ZyHXyiiz0Ne5aGZssoxRmcChw8/EFKQ5JwwkUo3FRT5yXS7q+Y/rHDZmFktzpGMvO+5QofA4FPpEmGw+EWRCFvnaof7Zhe8NuYSLR0xErKLThUSs8gnODh87ssy6438yzbLzxl012HS19vfCf3CNhnbWOL1eEsDda+gDPUvri8tSZzNFrwIZf1NmNvqC1I/t8j7nYAAAAASUVORK5CYII='); */
}

.immersive-translate-search-title {}

.immersive-translate-search-title-wrapper {}

.immersive-translate-search-time {
  font-size: 12px;
  margin: 4px 0 24px;
  color: #70757a;
}

.immersive-translate-expand-items {
  display: none;
}

.immersive-translate-search-more {
  margin-top: 16px;
  font-size: 14px;
}

.immersive-translate-modal {
  display: none;
  position: fixed;
  z-index: 1000000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0, 0, 0);
  background-color: rgba(0, 0, 0, 0.4);
  font-size:15px;
}

.immersive-translate-modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  border-radius: 10px;
  width: 80%;
  max-width: 500px;
  font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
    "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", "Noto Color Emoji";
}

.immersive-translate-modal-title {
  font-size: 1.3rem;
  font-weight: 500;
  margin-bottom: 20px;
  color: hsl(205, 20%, 32%);
}

.immersive-translate-modal-body {
  color: hsl(205, 20%, 32%)
}

.immersive-translate-close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.immersive-translate-close:hover,
.immersive-translate-close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.immersive-translate-modal-footer {
  display: flex;
  justify-content: flex-end;
  flex-wrap: wrap;
  margin-top: 20px;
}

.immersive-translate-btn {
  width: fit-content;
  color: #fff;
  background-color: #ea4c89;
  border: none;
  font-size: 14px;
  margin: 5px;
  padding: 10px 20px;
  font-size: 1rem;
  border-radius: 5px;
  display: flex;
  align-items: center;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.immersive-translate-btn:hover {
  background-color: #f082ac;
}
.immersive-translate-cancel-btn {
  /* gray color */
  background-color: rgb(89, 107, 120);
}


.immersive-translate-cancel-btn:hover {
  background-color: hsl(205, 20%, 32%);
}


.immersive-translate-btn svg {
  margin-right: 5px;
}

.immersive-translate-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #007bff;
  -webkit-tap-highlight-color: rgba(0, 0, 0, .1);
}

.immersive-translate-primary-link {
  cursor: pointer;
  user-select: none;
  -webkit-user-drag: none;
  text-decoration: none;
  color: #ea4c89;
  -webkit-tap-highlight-color: rgba(0, 0, 0, .1);
}

.immersive-translate-modal input[type="radio"] {
  margin: 0 6px;
  cursor: pointer;
}

.immersive-translate-modal label {
  cursor: pointer;
}

.immersive-translate-close-action {
  position: absolute;
  top: 2px;
  right: 0px;
  cursor: pointer;
}
</style></head>
<body>
<!-- navbar begin -->
<div class="navbar navbar-default">
    <div class="navbar-inner">
        <div class="container" style="text-align: center; position:relative;">
            <!--[if lte IE 8]>
            <span style="display:inline-block;margin:0 auto;color:red;">为了更好的体验，请使用IE10及以上版本</span>
            <![endif]-->
            <div class="brand-box">
                <a class="brand" href="https://xz.aliyun.com/tab/1"></a>
            </div>
            
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F12970&amp;from_type=xianzhi" class="pull-right anonymous-user hh_loding">
                    登录</a>
            
            <div class="nav-collapse collapse">
                <div class="search d1 text-right">
                    <form method="get" action="https://xz.aliyun.com/search">
                        <input type="text" placeholder="搜索" name="keyword">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- navbar end -->
<!-- main content begin -->
<div id="Wrapper" class="container">
    
    
    <div class="row2">
        <div class="span10">
            
    



    <script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/jquery.toc.min.js.下载"></script>
    <script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/toc.min.js.下载"></script>
    <script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/dt.js.下载"></script>
    


<div class="row box content">
    
    <div class="box-container">
        <div class="main-topic">
            <div class="clearfix user-info topic-list">
                <p><span class="content-title ">逻辑漏洞背后隐藏的刷票总结</span>
                </p>
                <div class="topic-info">
                <span class="info-left">
                    <a href="https://xz.aliyun.com/u/8351">
                        <span class="username cell"> 小陈</span></a> <span class="i-seprator"> / </span>
                    <span> 2023-11-03 19:11:00</span><span class="i-seprator"> / </span>
                    
                        <span>发表于新加坡 / </span>
                    
                    <span>浏览数 1990</span>
                    
                    
                    <span class="content-node">
                    
                        <span class="label label-default label-node-first">
                            <a href="https://xz.aliyun.com/tab/4">社区板块</a></span>
                        <span class="label label-default">
                            <a href="https://xz.aliyun.com/node/27">渗透测试</a></span>
                    
                    </span>
                </span>
                    <span class="pull-right t-vote cell info-right"><a class="vote vote-up" href="javascript:" onclick="voteUp(12970);">
             顶(3)</a>
             <a class="vote vote-down" href="javascript:" onclick="voteDown(12970);">
             踩(0)</a></span>
                </div>
            </div>
            <hr>
            <div id="topic_content" class="topic-content markdown-body">
                <h1>前言：</h1>
<p>说起刷票，可能大家都经常听到这个词，但是网上这种相关的漏洞文章却少之又少，本文将总结个人案例以及生活中碰到的情况汇总成本篇文章，刷票的行为通常是利用逻辑漏洞来实现的，比如通过伪造投票请求、绕过验证等手段来增加投票数量，从而拿到名次奖励，文章仅发表思路，这些思路不仅限于刷票。</p>
<h1>思路总结</h1>
<h2 id="toc-0">一、无任何验证措施</h2>
<p>程序开发问题，单一投票功能，用户可点击直接进行投票，且无任何限制，没有上限<br>
利用pyton写个简单的exp：</p>

<pre><code>import requests
url='http://www.domain.com/comment.php?aid=123&amp;who=1&amp;t=1385710179528'
while 1:
    requests.get(url)</code></pre>
<h2 id="toc-1">二、客户端验证</h2>
<p>一切来自客户端的数据都是不可信的，因为这些数据全部都是在前端<br>
1) 弹框提示，仅仅是弹框，并没有阻断后面代码执行，刷新页面继续投票，票数照常增加<br>
<a id="img0" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154824-5e171a52-7a1d-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154824-5e171a52-7a1d-1.png"></a><br>
2) 排除第一种情况，换个浏览器即可重新投票，或者清理下缓存即可重新投票<br>
<a id="img1" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154924-82069c44-7a1d-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154924-82069c44-7a1d-1.png"></a><br>
3) 有时候你可能也会碰到投票后按钮变为灰色，只需删除前端控制代码即可，或者直接往服务端进行发包，因为是客户端限制<br>
<a id="img2" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154931-86326370-7a1d-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103154931-86326370-7a1d-1.png"></a></p>
<h2 id="toc-2">三、User-Agent验证</h2>
<p>有的会用user-agent进行验证，毕竟打开页面，他也许就判断你的浏览器，觉得你只经常用这个浏览器，修改user-agent即可绕过</p>

<pre><code>Mozilla/5.0 (iPhone; CPU iPhone OS 10_0 like Mac OS X) AppleWebKit/602.1.38 (KHTML, like Gecko) Version/10.0 Mobile/14A5297c Safari/602.1
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.67 Safari/537.36 Edg/87.0.664.52
Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Mozilla/5.0 (Linux; Android 10; V1914A Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/77.0.3865.120 MQQBrowser/6.2 TBS/045410 Mobile Safari/537.36
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36
Mozilla/5.0 (compatible; NetcraftSurveyAgent/1.0; +info@netcraft.com)
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36
Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36
Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)
Mozilla/5.0 (compatible; SeznamBot/3.2; +http://napoveda.seznam.cz/en/seznambot-intro/)
Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36
Mozilla/5.0 (Windows NT 6.2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 QIHU 360SE; 360Spider
Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.75 Safari/537.36 Google Favicon
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko
Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
Mozilla/5.0 (Windows NT 6.3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Mozilla/5.0 Dalvik/2 ( Linux; U; NEM-AL10 Build/HONORNEM-AL10;Youku;7.1.4;) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Safari/537.36 (Baidu; P1 6.0) iPhone/7.1 Android/8.0
Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html\x09
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.67 Safari/537.36 Edg/87.0.664.55
Mozilla/5.0 (iPhone; CPU iPhone OS 14_0_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 SP-engine/2.25.0 main%2F1.0 baiduboxapp/12.4.0.13 (Baidu; P2 14.0.1) NABar/1.0
Mozilla/5.0 (Linux; Android 10; CDY-TN00 Build/HUAWEICDY-TN00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.108 Mobile Safari/537.36
Mozilla/5.0 (Linux; Android 4.1.1; Nexus 7 Build/JRO03D)
Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36
Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.75 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36; 360Spider
Mozilla/5.0 (Symbian/3; Series60/5.2 NokiaN8-00/012.002; Profile/MIDP-2.1 Configuration/CLDC-1.1 ) AppleWebKit/533.4(KHTML, like Gecko) NokiaBrowser/7.3.0Mobile Safari/533.4 3gpp-gba
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 11_0_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11) AppleWebKit/601.1.27 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/601.1.27
Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36
Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18363
Mozilla/5.0 (Linux; Android 5.0) AppleWebKit/537.36 (KHTML, like Gecko) Mobile Safari/537.36 (compatible; Bytespider; https://zhanzhang.toutiao.com/)
Mozilla/5.0 (Linux; Android 9; ANE-AL00 Build/HUAWEIANE-AL00; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/79.0.3945.116 Mobile Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 Edg/86.0.622.69
Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36
Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE
Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:36.0) Gecko/20100101 Firefox/36.0
Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/75.0.3770.90 Chrome/75.0.3770.90 Safari/537.36
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.1 Safari/605.1.15</code></pre>
<h2 id="toc-3">四、Cookie验证</h2>
<p>有时候会用绑定cookie来进行验证，一个cookie为一个用户，修改cookie即可绕过限制，有时候并不一定需要用户的cookie，可以随意修改两个字符尝试，也许会有意想不到的效果</p>
<h2 id="toc-4">五、IP验证</h2>
<p>有时候系统会根据ip来进行判断，一个ip投票一次，可尝试修改X-Forwarded-For，Clien-IP，可进行绕过<br>
<a id="img3" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103160157-42dfaf68-7a1f-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103160157-42dfaf68-7a1f-1.png"></a><br>
排除上面情况，还是使用ip进行验证，可使用ip代理池进行绕过</p>

<pre><code>import requests
from random import choice

# 代理池列表
proxy_list = ['http://ip1:port1', 'http://ip2:port2', 'http://ip3:port3']

# 随机选择一个代理
proxy = choice(proxy_list)

# 构造请求头
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'}

# 发送请求
try:
    response = requests.get('http://www.example.com', headers=headers, proxies={'http': proxy})
    print(response.text)
except:
    print('请求失败')</code></pre>
<p>tips:路由器每次重启ip不一样，手机开飞行模式也一样，代理ip也可以</p>
<h2 id="toc-5">六丶当投票量大于阅读量时就是刷票行为</h2>
<p>测试刷票漏洞时可以观察下阅读量，如果票数大于阅读量肯定就是刷票，假设根据前面的姿势刷票投到了第二，但某产商说我们统计结果会有人工判断，如果发现会进行漏洞降级，此时需要你的投票数量一定要符合阅读范围之内，如果绕过了限制进行刷票时，持续了一段时间失败了，请看浏览量，也许在此处做了判断<br>
<a id="img4" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103161012-69ec82ba-7a20-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103161012-69ec82ba-7a20-1.png"></a></p>
<h2 id="toc-6">七、组合拳1：Csrf刷票</h2>
<p>Csrf简介：攻击者利用用户已经登录的身份，在用户不知情的情况下向服务器发送恶意请求，从而实现攻击目的。攻击者通常会在第三方网站上植入恶意代码，当用户访问该网站时，代码就会自动向目标网站发送伪造的请求，从而欺骗服务器执行非法操作</p>
<p>Burp的Engagement tools功能可直接生成CSRF_PoC<br>
<a id="img5" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103162523-8865652a-7a22-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103162523-8865652a-7a22-1.png"></a></p>
<h2 id="toc-7">八、组合拳2：Xss打Cookie刷票</h2>
<p>如果站点存在xss，储存Xss就不用说了，配合Csrf直接自动化刷票了，即使是反射Xss也可以进行利用，比如"看这个人的票数好高，大家看看他是不是刷票:<a href="http://domain.com/" target="_blank">http://domain.com</a>" 同时网址缩短后做上跳转收集用户的Cookie，接着遍历Cookie批量发包即可实现刷票，如有Csrf也可以利用Csrf实现自动化刷票，相对没有储存Xss利用方便</p>
<h2 id="toc-8">九、观察数据包请求（验证参数等等）</h2>
<p>有的候系统在点击投票时会生成一个验证值，可能在Get，Post，Cookie，修改他们给的判断值即可实现刷票<br>
<a id="img6" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103162847-024f4950-7a23-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103162847-024f4950-7a23-1.png"></a></p>
<h2 id="toc-9">十、并发线程（条件竞争）</h2>
<p>利用前面方法我们无法进行刷票了，都被限制了，这时我们可以利用并发线程，简单来说就是让服务器处理跟不上请求速度，线程还没有达到需要验证的地方已经发出去了很多请求，用Fiddler批量发包，导致服务器没有跟上处理，导致刷票，出现问题的几率比较高<br>
<a id="img7" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103170302-cb640390-7a27-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103170302-cb640390-7a27-1.png"></a></p>
<h2 id="toc-10">十一、听说点击投票时出现验证码？</h2>
<h3 id="toc-11">(一)、验证码使用后不会销毁</h3>
<p>验证码可重复使用，不提示验证码错误<br>
<a id="img8" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103163930-816dea10-7a24-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103163930-816dea10-7a24-1.png"></a></p>
<h3 id="toc-12">(二)、生成验证码字符集可控</h3>
<p>验证码可控，可自行选择验证码（案例：ThinkCMF 1.X-2.X）<br>
<a id="img9" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164015-9c9af968-7a24-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164015-9c9af968-7a24-1.png"></a></p>
<h3 id="toc-13">(三)、验证码存放在暴露位置</h3>
<p><a id="img10" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164028-a42f78e8-7a24-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164028-a42f78e8-7a24-1.png"></a></p>
<h3 id="toc-14">(四)、验证码为空，或8888,0000等可绕过</h3>
<p>验证码为空，是因为程序逻辑错误，验证码验证一次之后本该退出此次验证码，生成新的，由于没有生成新的继续验证密码是否正确，8888,0000等为开发程序时设置的万能密码，方便测试，有时候会忘记删除</p>

<pre><code>1111
2222
3333
4444
5555
6666
7777
8888
9999</code></pre>
<h3 id="toc-15">(五)、验证码尺寸可控</h3>
<p>我们的主题是绕过验证码去投票，那么可以尺寸改为很小，仅有一个数字或者字母，这样很好去识别，从而进行绕过刷票</p>
<p>点缀一下其他的知识：如1.png?width=100      修改width控制大小，首先可造成Ddos<br>
该问题被人们广为关注源于PHPcms早期版本的后台登录验证码尺寸可控,可用于DDoS<br>
<a id="img11" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164812-b8bb0cae-7a25-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164812-b8bb0cae-7a25-1.png"></a></p>
<h3 id="toc-16">(六)、验证码过于简单,可轻易机器识别</h3>
<p>验证码过于简单,可轻易机器识别，同样可实现绕过刷票<br>
<a id="img12" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164953-f49a226e-7a25-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103164953-f49a226e-7a25-1.png"></a><br>
<a id="img13" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103165153-3c60cb7a-7a26-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103165153-3c60cb7a-7a26-1.png"></a></p>
<h3 id="toc-17">(七)、会话绕过</h3>
<p>当投票前几次没有验证码，而后又出现了验证码可能是因为一个会话的尝试次数比较多，可以尝试修改会话，直接清空缓存或打开隐私窗口</p>
<h2 id="toc-18">十二、听说还有手机号验证码投票？</h2>
<p>这个就更简单了，可以利用在线接码平台，这里分享几个，网上有很多，挖洞注册也一样可以用<br>
1）<a href="https://jiemahao.com/" target="_blank">https://jiemahao.com/</a> （免费）<br>
2）<a href="https://bestsms.xyz/" target="_blank">https://bestsms.xyz/</a> （免费）<br>
3）<a href="https://sms-activate.org/cn" target="_blank">https://sms-activate.org/cn</a> （付费）<br>
<a id="img14" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103163509-e5aef196-7a23-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103163509-e5aef196-7a23-1.png"></a></p>
<h1>案例1：记一次**刷票</h1>
<p>某天，早晨醒来，刚醒看到朋友发个投票的，让我投一下<br>
<a id="img15" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182319-02032cf4-7a33-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182319-02032cf4-7a33-1.png"></a><br>
先是正常投了一下，想着刚好看看测试一下，起床刷个牙，开开电脑，先抓包，分析一下，提示让用**投票<br>
<a id="img16" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231104164106-e531dac4-7aed-1.jpg"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231104164106-e531dac4-7aed-1.jpg"></a><br>
此时我再用客户端的**进行登陆抓包，发现提示还是一样<br>
<a id="img17" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231104164342-41e3776e-7aee-1.jpg"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231104164342-41e3776e-7aee-1.jpg"></a><br>
思考一下，他是如何判断我是否用的**？<br>
我明明用的**，而提示没用**，猜测肯定是User-Agent搞的鬼<br>
<a id="img18" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171024-d2c9f6e8-7a28-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171024-d2c9f6e8-7a28-1.png"></a><br>
因为是客户端的**，所以User-Agent还是根据系统的显示，替换个手机的User-Agent，提示如下：<br>
<a id="img19" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182844-c40ad612-7a33-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182844-c40ad612-7a33-1.png"></a><br>
可以看到，可以进行投票了，不过提示投票过多，明天再试<br>
此时分析Post数据包看到有个token值，猜测token来进行判断的，因为token也属于表示用户身份的特征<br>
测试随便修改一位数，发现投票成功<br>
<a id="img20" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182943-e6fe45dc-7a33-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182943-e6fe45dc-7a33-1.png"></a><br>
遍历投票<br>
<a id="img21" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183022-feb02862-7a33-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183022-feb02862-7a33-1.png"></a><br>
1：<br>
<a id="img22" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171148-046cc888-7a29-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171148-046cc888-7a29-1.png"></a><br>
2：<br>
<a id="img23" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171150-05964126-7a29-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103171150-05964126-7a29-1.png"></a></p>
<h1>案例2：记一次为学校排行刷票</h1>
<p>一个漆黑的夜晚，接近十一点，辅导员在群里发了一个高校排行投票<br>
<a id="img24" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103181653-1c03394c-7a32-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103181653-1c03394c-7a32-1.png"></a><br>
打开看了下，我们学校才第三，1000+票，第一名 2W+（xxx信息工程xx）<br>
相信他们是刷的票，搞信息的学校，肯定有大师傅<br>
首先分析了一下，Cookie 不会验证用户：<br>
<a id="img25" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183117-1f1fb838-7a34-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183117-1f1fb838-7a34-1.png"></a><br>
ip 也不会验证用户：<br>
<a id="img26" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183259-5bc9bf9a-7a34-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103183259-5bc9bf9a-7a34-1.png"></a><br>
发现上面有两个参数，一个vid 是指学校<br>
id测试发现投票成功为4，但是投票到达一定次数就会换另一个值，Bp遍历一下<br>
<a id="img27" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182015-94d99ef6-7a32-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182015-94d99ef6-7a32-1.png"></a><br>
持续几十票，id就不可以用了，发现增加1位即可投票成功，既然知道了规律，那还等什么！<br>
<a id="img28" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182116-b8c20286-7a32-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182116-b8c20286-7a32-1.png"></a><br>
刷之后，稳定排名第二<br>
<a id="img29" href="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182253-f2e3e042-7a32-1.png"><img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/20231103182253-f2e3e042-7a32-1.png"></a></p>
<h1>结束语</h1>
<p>针对投票这方面产商可以加强验证机制、如随机token+服务端验证，在提交表单处再次增加随机校验码等等，上面思路仅是在刷票途中用到的一些思路，最重要的是师傅们要学到技巧，用到其他情况上面，并不单单指投票，就比如看到某个功能点就会考虑存在哪些漏洞，漏洞应该在什么点会触发！</p>

            </div>
            

            <div class="post-user-action" style="margin-top: 34px;">
                <span class="btn btn-default pull-right" id="mark" data-action="topic" data-pk="12970">
                    <span id="mark-text">点击收藏 </span><span class="i-seprator"> | </span><span id="mark-count">0</span>
                </span>
                
                    <span class="btn btn-default pull-right" id="follow_topic" data-pk="12970">
                     <span>关注</span><span class="i-seprator"> | </span><span id="follow-count">1</span>
                    </span>
                
                
                    <span class="btn btn-default pull-right">
                     <span>
                         
                             <span id="ready_reward" data-toggle="modal" data-target="#myModal">打赏</span>
                         
                     </span>
                    </span>
                
                <div class="clearfix"></div>
            </div>
            
                <div class="related-section">
                    <div class="related-box">
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/12969" title="多款Java模板引擎对比与模板注入的安全之旅"><span class="related-label" style="padding: 3px 4px;margin-right: 3px;">上一篇：</span>多款Java模板引擎对比与模板注入...</a></span>
                        
                        
                            <span><a class="pull-left" href="https://xz.aliyun.com/t/12971" title="域渗透实战之Sunday"><span class="related-label" style="">下一篇：</span>域渗透实战之Sunday</a></span>
                        
                    </div>
                </div>
            
        </div>
    </div>
</div>
<div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel" style="text-align: center">
                    积分打赏
                </h4>
            </div>
            <div class="modal-body" id="button-value">
                <div style="text-align: center;">
                 <div role="group">
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type1">
                        1分
                    </button>
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type2">
                        2分
                    </button>
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type3">
                        5分
                    </button>
                 </div>
                 <br>
                 <div style="margin-top: 20px">
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type4">
                        8分
                    </button>
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type5">
                        10分
                    </button>
                    <button type="button" class="btn btn-secondary m64" style="min-width: 64px;" data-value="type6">
                        20分
                    </button>
                 </div>
                </div>
            </div>
            <div class="modal-footer" id="confirm">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" id="reward_topic" data-pk="12970">确定</button>
            </div>
        </div>
    </div><!-- /.modal -->
</div>

    <!-- topic & appendix -->
    



<div class="row box">
    <ol class="breadcrumb">
        <li class="active">0 条回复</li>
    </ol>
    <div class="box-container post-container">
        
            <ul>
                <li style="min-height: 50px;line-height: 60px;margin-left: 15px"><strong>动动手指，沙发就是你的了！</strong></li>
            </ul>
        
    </div>
</div>


    <!-- posts of topic -->
    
        <div class="row box" id="reply-box">
            
            <div class="box-container clearfix">
                
                    <div class="reminder">
                        <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F12970&amp;from_type=xianzhi"><strong>登录</strong></a> 后跟帖
                    </div>
                
            </div>
        </div>
    
    <!-- editor for post -->
    

        </div>
        <div class="span3 pull-right offset sidebar">
            


    <div class="box">
        <div class="info-panel">
            <p><strong>先知社区</strong></p>
            <hr>
            <p class="text-center login-btn">
                <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F12970&amp;from_type=xianzhi" class="btn">现在登录</a>
            </p>
        </div>
    </div>



    <div class="box">
        <div class="hot-node notice">
            <div class="info-body">
                <a href="https://xz.aliyun.com/notice" style="padding: 4px 10px 4px 10px;">社区小黑板</a>
            </div>
        </div>
    </div>


<div class="box">
    <div class="global-charts">
        <div id="chart-header">
            <div class="col-sm-4 text-center charts" data-type="year">
                年度贡献榜
            </div>
            <div class="text-center charts active" data-type="month">
                月度贡献榜
            </div>
            <div class="clearfix"></div>
        </div>
        <div id="chart_body">
            <div class="info-body" data-type="year">

                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/45806" title="0x0101">0x0101</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/49646" title="frank·zhu">frank·zhu</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/42027" title="yxxxdd">yxxxdd</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>

                    </div>
                
                    <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/26703_bc0e9e35623dbb9aa3.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/26703" title="任意门">任意门</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>

                    </div>
                
            </div>
            <div class="info-body" data-type="month">
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/45806" title="0x0101" style="">0x0101</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/49646" title="frank·zhu" style="">frank·zhu</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/default_avatar.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/42027" title="yxxxdd" style="">yxxxdd</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
                     <div class="member">
                        <div class="pull-left chart-avatar">
                            
                                <img src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/26703_bc0e9e35623dbb9aa3.png">
                            
                        </div>
                        <div class="chart-name">
                            <a class="nickname" href="https://xz.aliyun.com/u/26703" title="任意门" style="">任意门</a>
                            <span class="num-box">
                                <span class="badge badge-important">1</span>
                            </span>
                        </div>
                    </div>
                
            </div>
        </div>

    </div>
</div>

    <div class="box" id="toc-container" style="width: 176px;">
        <div class="panel-info">
            <div class="panel-heading">
                <h4>目录</h4>
            </div>
            <div id="toc">
                <div class="high-light" style="display: block; background-color: rgb(243, 243, 243); position: absolute; height: 26px; top: 50px;"></div>
            <ol style="top: 50px;"><li><a href="https://xz.aliyun.com/t/12970#toc-0">一、无任何验证措施</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-1">二、客户端验证</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-2">三、User-Agent验证</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-3">四、Cookie验证</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-4">五、IP验证</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-5">六丶当投票量大于阅读量时就是刷票行为</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-6">七、组合拳1：Csrf刷票</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-7">八、组合拳2：Xss打Cookie刷票</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-8">九、观察数据包请求（验证参数等等）</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-9">十、并发线程（条件竞争）</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-10">十一、听说点击投票时出现验证码？</a><ol><li><a href="https://xz.aliyun.com/t/12970#toc-11">(一)、验证码使用后不会销毁</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-12">(二)、生成验证码字符集可控</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-13">(三)、验证码存放在暴露位置</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-14">(四)、验证码为空，或8888,0000等可绕过</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-15">(五)、验证码尺寸可控</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-16">(六)、验证码过于简单,可轻易机器识别</a></li><li><a href="https://xz.aliyun.com/t/12970#toc-17">(七)、会话绕过</a></li></ol></li><li><a href="https://xz.aliyun.com/t/12970#toc-18">十二、听说还有手机号验证码投票？</a></li></ol></div>
        </div>
    </div>
    <div style="clear: both;"></div>


    <script type="text/javascript">
        $(function () {
            $(".charts").click(switchChart);
            $("[data-toggle='tooltip']").tooltip();

            function switchChart() {
                let _this = $(this);
                let idx = _this.attr("data-type")
                let content = $(`#chart_body>.info-body[data-type='${idx}']`)
                if (!_this.hasClass("active")) {
                    _this.addClass("active").siblings().removeClass("active")
                    content.show().siblings().hide()
                }
            }
        })
    </script>


    <style>

    </style>


        </div>
    </div>


</div>
<footer class="bs-docs-footer">
    <div class="container text-center">
        <div class="links">
            <a href="https://xz.aliyun.com/feed" target="_blank">RSS</a>
            <a href="https://xz.aliyun.com/about" target="_blank"><span>关于社区</span></a>
            <a href="https://xz.aliyun.com/partner" target="_blank"><span>友情链接</span></a>
            <a href="https://xz.aliyun.com/notice">社区小黑板</a>
            <a href="https://report.aliyun.com/" target="_blank">举报中心</a>
            <a href="https://www.aliyun.com/complaint" target="_blank">我要投诉</a>
        </div>
    </div>
</footer>

<script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/bootstrap.min.js.下载"></script>
<script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/xz.js.下载"></script>


    
    <script type="text/javascript">
        $(document).ready(function () {
            voteUp = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/up/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F12970&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-up').html(data.html);
                                }
                            }
                        }
                    });
                }
            };
            voteDown = function (topicPk) {
                if (topicPk) {
                    $.ajax({
                        url: '/forum/topic/down/',
                        data: {'pk': topicPk},
                        type: 'post',
                        dataType: 'json',
                        success: function (data) {
                            if (data.not_authenticated) {
                                window.location.href = 'https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F12970&amp;from_type=xianzhi'
                            } else {
                                if (data.success) {
                                    $('.t-vote > .vote-down').html(data.html);
                                }
                            }

                        }
                    });
                }
            };
            
            $("[data-toggle='tooltip']").tooltip();
        });
    </script>


    <script src="./逻辑漏洞背后隐藏的刷票总结 - 先知社区_files/z_stat.php"></script>


</body></html>