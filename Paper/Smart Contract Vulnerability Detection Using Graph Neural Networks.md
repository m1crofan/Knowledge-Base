### 摘要

探索使用图神经网络GNN进行智能合约漏洞检测。特别是，构建了一个合约图来表示智能合约函数的语法和语义结构。为了突出主要节点，我们设计了一个消除阶段来规范化图表。然后，提出了一种无度图卷积神经网络（DR-GCN）和一种新颖的时间消息传播网络（TMP），以从归一化图中学习以进行漏洞检测。

### 我们的方法

> 我们根据程序语句之间的数据和控制依赖关系将智能合约的源代码描述为合约图。图中的节点表示关键函数调用或关键变量，而边捕获它们的时间执行轨迹。由于大多数GNN在信息传播过程中本质上是平坦的，因此我们设计了一个消除阶段来规范化图。我们将GCN扩展到无度GCN（DR-GCN）来处理标准化图。此外，我们考虑了不同程度元素的不同角色和时间关系，提出了一种新颖的时间消息传播网络（TMP）。

![image-20231010144934873](https://raw.githubusercontent.com/m1crofan/image/main/image-20231010144934873.png)

#### 图神经网络

> DR-GCN
>
> 图在数据预处理中进行了很好的归一化，因此从方程中删除对角度矩阵。
>
> TMP
>
> 由消息传播阶段和读出阶段组成，在消息传播阶段，TMP按照时间顺序沿着边缘连续传递信息。然后，TMP使用读出函数计算整个图G的标签，改函数聚合G中所有节点的最终状态。